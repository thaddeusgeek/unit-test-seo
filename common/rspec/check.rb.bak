
require 'mechanize'

regexp_path = ARGV[0] || './regexp';

File.new(regexp_path).each do |line|
  meta = {}
  items = line.split
	meta[:url]         = items[1]
  meta[:title]       = items[2]
	meta[:keywords]    = items[5]
	meta[:description] = items[7]
  url = items[1]
  agent = Mechanize.new
	begin
    agent.get(url)
  rescue Mechanize::ResponseCodeError => ex
	  puts ex.response_code
	end
	page = {}
	page[:url]         = url
	page[:title]       = agent.page.title
	page[:keywords]    = agent.page.search('meta')[3].attributes['content'].value
	page[:description] = agent.page.search('meta')[4].attributes['content'].value

  describe "#{items[0]}" do
	  before(:each) do
		  @meta = meta
			@page = page
		end

    it_behaves_like "BASIC"
  end
end

